parameters: 
  - name: imageName
    type: string
    default: osm-helm-cli
  - name: imageTag
    type: string
    default: test
  - name: platform
    type: string
    default: linux/amd64
  - name: baseImage
    type: string
    default: k8s.gcr.io/build-image/debian-base:bullseye-v1.1.0

steps:
  - bash: |
      docker buildx build --build-arg base_image=${{ parameters.baseImage }} -t ${{ parameters.imageName }}:${{ parameters.imageTag }} --platform ${{ parameters.platform }} --output=type=docker $(helm.cli.path)/.
    displayName: Build helm-cli image
